{% extends 'base.html' %}
{% load crispy_forms_tags %} {% load static %}
{% block title %} {{ object }} {% endblock title %}
{% block main %}
  <div class="row py-3">
    <div class="col-md-12 m-auto">
      <div class="card shadow">
        <div class="card-header justify-content-between">
          <h3 class="card-title fw-semibold">{{ object }}</h3>
          <a class="btn btn-primary" href="{% url 'paceapp:update_course' pk=object.pk %}">Update</a>
        </div>
        <div class="card-body">
          <div class="datagrid">
            <div class="datagrid-item">
              <div class="datagrid-title">Country</div>
              <div class="datagrid-content">{{ object.country }}</div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">University</div>
              <div class="datagrid-content">
                <a href="{{ object.university.get_absolute_url }}">
                  {{ object.university }}
                </a>
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Level</div>
              <div class="datagrid-content">
                {{ object.level|default_if_none:'-' }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Stream</div>
              <div class="datagrid-content">
                {{ object.stream }}
              </div>
            </div>
{#            <div class="datagrid-item">#}
{#              <div class="datagrid-title">SubStream</div>#}
{#              <div class="datagrid-content">#}
{#                {{ object.substream|default_if_none:'-' }}#}
{#              </div>#}
{#            </div>#}
            <div class="datagrid-item">
              <div class="datagrid-title">Campus</div>
              <div class="datagrid-content">
                {% for campus in object.campus.all %}
                  {{ campus }},
                {% endfor %}
              </div>
            </div>

            <div class="datagrid-item">
              <div class="datagrid-title">Intake</div>
              <div class="datagrid-content">
                {% for intake in object.intake.all %}
                  {{ intake }},
                {% endfor %}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Tuition Fees</div>
              <div class="datagrid-content">
                {{ object.tuition_fees }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Scholarship Fees</div>
              <div class="datagrid-content">
                {{ object.scholarship }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Entry Requirement</div>
              <div class="datagrid-content">
                {{ object.entry_requirement }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Course University Site Link</div>
              <div class="datagrid-content">
                <a href="{{ object.link }}" target="_blank">View Course details</a>
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Course Added on</div>
              <div class="datagrid-content">
                {{ object.created }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Last Updated</div>
              <div class="datagrid-content">
                {{ object.modified }}
              </div>
            </div>
            <div class="datagrid-item">
              <div class="datagrid-title">Status</div>
              <div class="datagrid-content">
                {% if object.is_active %}
                  <span class="status status-success">Active</span>
                {% else %}
                  <span class="status status-secondary">Inactive</span>
                {% endif %}
              </div>
            </div>
          </div>
        </div>

        <div class="card-footer border-bottom">
          <div class="justify-content-between d-flex">
            <h4 class="">Entry Criteria</h4>
            {% if object.level.level == "Postgraduate" %}
              <a class="btn btn-green" href="{% url 'paceapp:add_pg_course_requirements' pk=object.pk %}">Add Course
                Requirements</a>
            {% elif object.level.level == "Undergraduate" %}
              <a class="btn btn-green" href="{% url 'paceapp:add_course_requirements' pk=object.pk %}">Add Course
                Requirements</a>
            {% endif %}
          </div>
        </div>

        {% if object.level.level == "Postgraduate" %}
          {% include 'paceapp/course/entry_criteria_component/pg_entry_criteria.html' %}
        {% elif object.level.level == "Undergraduate" %}
          {% include 'paceapp/course/entry_criteria_component/ug_entry_criteria.html' %}
        {% endif %}

        {#        English test requirements.#}
        {% include 'paceapp/course/entry_criteria_component/english_test_requirement.html' %}
        <div class="card-footer"></div>
      </div>
    </div>
  </div>
{% endblock %}

{% block modal %}
  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this entry criteria?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirmDelete">Delete</button>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block inline_javascript %}
  <script>
    // Function to handle delete button click
    var deleteButtons = document.querySelectorAll('.delete-entry-criteria');
    deleteButtons.forEach(function (button) {
      button.addEventListener('click', function () {
        var url = button.dataset.url;
        document.getElementById('confirmDelete').setAttribute('data-url', url);
      });
    });

    // Function to handle confirm deletion
    var confirmButton = document.getElementById('confirmDelete');
    confirmButton.addEventListener('click', function () {
      var url = confirmButton.dataset.url;
      window.location.href = url;
    });
  </script>
{% endblock %}
