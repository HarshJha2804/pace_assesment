{% extends 'base.html' %}
{% load crispy_forms_tags %} {% load static %}
{% block title %} Super admin Dashboard {% endblock title %}
{% block main %}
  <div class="row rounded  mb-5  py-3">
    {#  Section for general data #}
    <div class="col-md-12 mb-4">
      <div class="card shadow shadow-sm" style="background-color: #170fd5!important;">
        <div class="card-header d-flex justify-content-between">
          <h3 class="card-title fw-semibold text-light">Dashboard</h3>
          <h3 class="card-title fw-semibold text-light text-decoration-underline"><a
            href="{% url 'paceapp:project_wise_dashboard' %}" target="_blank">Project Wise Dashboard</a></h3>
        </div>
        <div class="card-body">
          <div class="row mb-2 gy-3">
            <div class="col-sm-6 col-lg-4 ">
              <div style="border-width: 6px; border-radius: 10px"
                   class="card shadow shadow-sm card-sm border-3 border-start-5 border-top-0 border-end-0 border-bottom-0 border-rss">
                <div class="py-3 px-3 rounded-5">
                  <div class="row m-0">
                    <div class="col d-flex flex-column gap-2">
                      <div class="d-flex flex-row justify-content-between align-items-center">
                        <div class="d-flex flex-column gap-2">
                          <div class="fw-bold fs-3 text-uppercase">
                            Total Partners
                          </div>
                          <div class="text-primary-emphasis fs-1 fw-semibold">
                            <a href="{% url 'paceapp:partner_list' %}" target="_blank">{{ total_partner_count }}</a>
                          </div>
                        </div>
                        <div class="p-3 bg-rss rounded-5">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                               stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                               class="icon icon-tabler icons-tabler-outline icon-tabler-users">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"></path>
                            <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            <path d="M21 21v-2a4 4 0 0 0 -3 -3.85"></path>
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-lg-4 ">
              <div style="border-width: 6px; border-radius: 10px"
                   class="card shadow shadow-sm card-sm border-3 border-start-5 border-top-0 border-end-0 border-bottom-0 border-cyan">
                <div class="py-3 px-3 rounded-5">
                  <div class="row m-0">
                    <div class="col d-flex flex-column gap-2">
                      <div class="d-flex flex-row justify-content-between align-items-center">
                        <div class="d-flex flex-column gap-2">
                          <div class="fw-bold fs-3 text-uppercase">
                            Total Students
                          </div>
                          <div class="text-primary-emphasis fs-1 fw-semibold">
                            <a href="{% url 'paceapp:student_list' %}" target="_blank">{{ total_student_count }}</a>
                          </div>
                        </div>
                        <div class="p-3 bg-cyan rounded-5">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256"
                               fill="none" class="text-light">
                            <path fill="currentColor"
                                  d="m226.53 56.41l-96-32a8 8 0 0 0-5.06 0l-96 32A8 8 0 0 0 24 64v80a8 8 0 0 0 16 0V75.1l33.59 11.19a64 64 0 0 0 20.65 88.05c-18 7.06-33.56 19.83-44.94 37.29a8 8 0 1 0 13.4 8.74C77.77 197.25 101.57 184 128 184s50.23 13.25 65.3 36.37a8 8 0 0 0 13.4-8.74c-11.38-17.46-27-30.23-44.94-37.29a64 64 0 0 0 20.65-88l44.12-14.7a8 8 0 0 0 0-15.18ZM176 120a48 48 0 1 1-86.65-28.45l36.12 12a8 8 0 0 0 5.06 0l36.12-12A47.9 47.9 0 0 1 176 120m-48-32.43L57.3 64L128 40.43L198.7 64Z"/>
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-lg-4 ">
              <div style="border-width: 6px; border-radius: 10px"
                   class="card shadow shadow-sm card-sm border-3 border-start-5 border-top-0 border-end-0 border-bottom-0 border-github">
                <div class="py-3 px-3 rounded-5">
                  <div class="row m-0">
                    <div class="col d-flex flex-column gap-2">
                      <div class="d-flex flex-row justify-content-between align-items-center">
                        <div class="d-flex flex-column gap-2">
                          <div class="fw-bold fs-3 text-uppercase">
                            Total Applications
                          </div>
                          <div class="text-primary-emphasis fs-1 fw-semibold">
                            <a href="{% url 'core:application_list' %}"
                               target="_blank">{{ total_application_count }}</a>
                          </div>
                        </div>
                        <div class="p-3 bg-github rounded-5">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                               stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                               class="icon icon-tabler icons-tabler-outline icon-tabler-checklist">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M9.615 20h-2.615a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8"></path>
                            <path d="M14 19l2 2l4 -4"></path>
                            <path d="M9 8h4"></path>
                            <path d="M9 12h2"></path>
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {% for country in country_status_list %}
      <div class="col-md-12 mb-4">
        <div
          class="card shadow shadow-sm bg-indigo-lt">
          <div class="card-header">
            <h3 class="card-title fw-bolder"><span class="text-dark">{{ country.country }}</span> Dashboard <i
              class='bx bxs-dashboard'></i></h3>
          </div>
          <div class="card-body">
            <div class="row">
              {% for status in country.statuses %}
                <div class="col-sm-6 col-lg-3 mb-3">
                  <div style="border-width: 6px; border-radius: 10px"
                       class="card shadow shadow-sm card-sm border-3 border-start-5 border-top-0 border-end-0
                       border-bottom-0 border-{% cycle 'rss' 'pink' 'yellow' 'dark' 'blue' %}">
                    <div class="rounded-5">
                      <div class="row m-0">
                        <div class="col d-flex flex-column gap-2">
                          <div class="d-flex flex-row justify-content-between align-items-center">
                            <div class="d-flex flex-column gap-2">
                              <h5 class="font-weight-medium fs-4 m-0">
                                {{ status.status }}
                              </h5>
                            </div>
                            <div class="p-2 text-primary-emphasis fs-3">
                              {% if status.status == 'Total Students' %}
                                <a target="_blank"
                                   href="{% url 'paceapp:student_list' %}?study_country={{ country.country.id }}">
                                  {{ status.count }}
                                </a>

                              {% else %}
                                <a target="_blank"
                                   href="{% url 'core:application_list' %}?country={{ country.country.id }}&status={{ status.status.name }}">
                                  {{ status.count }}
                                </a>
                              {% endif %}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    {% endfor %}

    {# University logo list start #}
    {% for country_info in country_status_list %}
      {% with universities_with_logo=country_info.universities %}
        {% if universities_with_logo %}
          <div class="col-md-12 mb-4">
            <div class="card shadow shadow-sm bg-indigo-lt">
              <div class="card-header">
                <h2 class="card-title fw-bolder">
                  <span class="text-dark">{{ country_info.country.country_name }}</span>
                </h2>
              </div>
              <div class="card-body">
                <div class="university-logos d-flex flex-wrap align-items-center gap-16">
                  {% for university in universities_with_logo %}
                    {% if university.logo %}
                      <a target="_blank" href="{% url 'paceapp:university_applications' university.pk %}">
                        <div class="avatar rounded-square me-1 mb-1"
                             style="
                               {#background-image: url('{{ university.get_logo_url }}');#}
                               {#background-size: cover;#}
                               {#background-position: center;#}
                               background-color: white;
                               min-width:17rem; min-height: 5rem; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: white; margin:0.5rem 0.5rem">
                          <img alt="Logo" src='{{ university.get_logo_url }}' style="height:4rem"/>
                        </div>
                      </a>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endwith %}
    {% endfor %}
    {# University logo list End #}

    {#  Last Three Days Activity#}
    <div class="col-md-12 mb-3">
      <div class="card shadow shadow-sm">
        <div class="card-header fw-bold">Last 3 Day Activity</div>
        <div class="table-responsive">
          <table class="table table-vcenter card-table table-striped">
            <thead class="sticky-top">
            <tr>
              <th class="border-end ">Date</th>
              {% for status in status_list %}
                <th class="border-end">{{ status }}</th>
              {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for item in activities %}
              <tr>
                <td class="border-end text-nowrap">{{ item.date|date }}</td>
                {% for status_count_dict in item.status_counts %}
                  <td class="border-end text-center">
                    <a
                      href="{% url 'core:application_list' %}?status={{ status_count_dict.status }}&date={{ item.date|date:"d-m-Y" }}">
                      {{ status_count_dict.count }}
                    </a>
                  </td>
                {% endfor %}
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="card-footer"></div>
      </div>
    </div>

  </div>
{% endblock %}
